# WhisperAPI-to-CSV-recorder

## Описание
Данное приложение предназначено для записи аудио-переговоров, автоматической транскрибации речи с использованием Whisper API от OpenAI и сохранения результатов в CSV-файлы. Программа имеет удобный графический интерфейс, позволяющий выбирать устройства записи, язык распознавания и другие параметры.

## Возможности
- Запись аудио с любого доступного устройства
- Транскрибация речи на русском, казахском, английском языках или с автоматическим определением языка
- Индикация уровня громкости в реальном времени
- Сохранение результатов в CSV-файлы с метаданными (имя менеджера, дата, ID переговора)
- Обработка длинных записей с разбивкой на части

## Требования
- Python 3.12.7 (протестировано на этой версии)
- Установленные библиотеки из файла requirements.txt
- API ключ OpenAI (для доступа к Whisper API)
- FFmpeg (для обработки аудиофайлов)

## Установка

### 1. Клонирование репозитория
```bash
git clone https://github.com/zsfree/WhisperAPI-to-CSV-recorder.git
cd WhisperAPI-to-CSV-recorder
```

### 2. Установка зависимостей
```bash
python.exe -m pip install --upgrade pip
pip install -r requirements.txt
pip install --upgrade openai
```

### 3. Настройка API ключа
В файле `.env` в корневой директории проекта укажите ваш API-ключ OpenAI:
```
OPENAI_API_KEY=ваш_ключ_api
```

### 4. Установка FFmpeg
FFmpeg необходим для обработки аудиофайлов. Его можно установить одним из следующих способов:

**Windows:**
1. Скачайте FFmpeg с официального сайта: https://ffmpeg.org/download.html
2. Распакуйте архив и поместите файлы в папку `ffmpeg` внутри проекта, или
3. Добавьте путь к исполняемым файлам FFmpeg в переменную среды PATH

**Linux:**
```bash
sudo apt-get update
sudo apt-get install ffmpeg
```

**macOS:**
```bash
brew install ffmpeg
```

## Использование

### Запуск приложения
```bash
python main.py
```

### Основные шаги работы
1. Выберите или создайте CSV-файл для сохранения результатов
2. Выберите устройство записи из выпадающего списка
3. Выберите язык распознавания речи (русский, казахский, английский или автоопределение)
4. Введите имя менеджера и ID переговора
5. Нажмите кнопку "Запись" для начала записи
6. По окончании записи нажмите кнопку "Остановить" для завершения записи и начала транскрибации
7. После завершения транскрибации проверьте результат и нажмите "Сохранить в CSV"

## Структура проекта
- `main.py` - основной файл приложения и пользовательский интерфейс
- `recorder.py` - модуль для записи аудио
- `transcriber.py` - модуль для работы с Whisper API и транскрибации аудио
- `csv_handler.py` - модуль для работы с CSV-файлами
- `requirements.txt` - список зависимостей
- `icon.ico` - иконка приложения
- `recordings/` - папка для сохранения записанных аудиофайлов
- `.gitignore` - файл с правилами игнорирования файлов для Git
- `.env` - шаблон для файла с API-ключом OpenAI

## Технические детали
- Аудио записывается в формате WAV с частотой дискретизации 44100 Гц
- Транскрипция выполняется с помощью модели Whisper от OpenAI
- Для обработки файлов размером более 25 МБ используется автоматическое разбиение на части
- Индикатор уровня громкости обновляется в реальном времени

## Решение проблем
- **Не найден API ключ OpenAI**: Убедитесь, что вы создали файл `.env` с корректной переменной OPENAI_API_KEY
- **Не найдено устройство записи**: Проверьте подключение микрофона и его работоспособность
- **FFmpeg не найден**: Установите FFmpeg и убедитесь, что он доступен в PATH или находится в папке проекта
- **Ошибка при транскрибации**: Проверьте подключение к интернету и валидность API ключа OpenAI

## Лицензия
Этот проект распространяется под лицензией MIT. См. файл [LICENSE](LICENSE) для получения дополнительной информации.



## Благодарности
- OpenAI за предоставление API Whisper для транскрибации речи
- Разработчикам библиотеки CustomTkinter за улучшенный интерфейс
